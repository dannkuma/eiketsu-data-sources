#!/bin/sh
set -e

echo "ğŸ”¥ pre-commit hook is running ğŸ”¥"

# ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ã•ã‚ŒãŸ PHP ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆsrc/ é…ä¸‹ï¼‰ã‚’å–å¾—
PHP_FILES=$(git diff --cached --name-only --diff-filter=ACM \
  | grep '^src/.*\.php$' \
  | sed 's#^src/##' \
  || true)

[ -z "$PHP_FILES" ] && exit 0

echo "Start Linting with laravel/pint."

docker compose exec -T app ./vendor/bin/pint $PHP_FILES

# æ•´å½¢å¾Œã«å†ã‚¹ãƒ†ãƒ¼ã‚¸
git add $(echo "$PHP_FILES" | sed 's#^#src/#')
